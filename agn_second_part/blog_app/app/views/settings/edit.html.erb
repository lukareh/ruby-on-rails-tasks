<% content_for :title, "Account Settings" %>

<div style="max-width: 700px; margin: 0 auto;">
  <div style="margin-bottom: 3rem;">
    <h1 style="font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem;">Account Settings</h1>
    <p style="color: #757575; font-size: 1.1rem;">Manage your profile and security settings</p>
  </div>

  <%= form_with model: @user, url: settings_path, method: :patch do |f| %>
    <% if @user.errors.any? %>
      <div class="alert alert-error" style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">
          <%= pluralize(@user.errors.count, "error") %> prohibited this from being saved:
        </h3>
        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
          <% @user.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <!-- profile section -->
    <div style="background: #f9f9f9; padding: 2rem; border-radius: 8px; margin-bottom: 2rem;">
      <h2 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: #1a1a1a;">Profile Information</h2>
      
      <div class="form-group">
        <%= f.label :name, "Full Name", class: "form-label" %>
        <%= f.text_field :name, disabled: true, value: @user.name, class: "form-input", style: "background: #e8e8e8; cursor: not-allowed;" %>
        <small style="color: #757575; font-size: 0.85rem;">Contact admin to change your name</small>
      </div>

      <div class="form-group">
        <%= f.label :email, "Email Address", class: "form-label" %>
        <%= f.email_field :email, disabled: true, value: @user.email, class: "form-input", style: "background: #e8e8e8; cursor: not-allowed;" %>
        <small style="color: #757575; font-size: 0.85rem;">Contact admin to change your email</small>
      </div>
    </div>

    <!-- password section -->
    <div style="background: #f9f9f9; padding: 2rem; border-radius: 8px; margin-bottom: 2rem;">
      <h2 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: #1a1a1a;">Change Password</h2>

      <div class="form-group">
        <%= f.label :current_password, "Current Password", class: "form-label" %>
        <%= f.password_field :current_password, autocomplete: "current-password", class: "form-input", placeholder: "Enter your current password" %>
      </div>

      <div class="form-group">
        <%= f.label :password, "New Password", class: "form-label" %>
        <%= f.password_field :password, autocomplete: "new-password", class: "form-input", placeholder: "Enter new password" %>
        <small style="color: #757575; font-size: 0.85rem;">Minimum 6 characters</small>
      </div>

      <div class="form-group">
        <%= f.label :password_confirmation, "Confirm New Password", class: "form-label" %>
        <%= f.password_field :password_confirmation, autocomplete: "new-password", class: "form-input", placeholder: "Confirm new password" %>
      </div>
    </div>

    <!-- profile picture section -->
    <div style="background: #f9f9f9; padding: 2rem; border-radius: 8px; margin-bottom: 2rem;">
      <h2 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: #1a1a1a;">Profile Picture</h2>

          <% if @user.avatar.attached? %>
        <div style="margin-bottom: 1.5rem;">
          <p style="color: #757575; margin-bottom: 1rem; font-weight: 600;">Current Profile Picture:</p>
          <div style="width: 120px; height: 120px; border-radius: 50%; overflow: hidden; border: 3px solid #ff6b35;">
            <%= image_tag @user.avatar, style: "width: 100%; height: 100%; object-fit: cover;" %>
          </div>
        </div>
      <% else %>
        <div style="margin-bottom: 1.5rem;">
          <div style="width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(135deg, #ff6b35, #ff8555); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 3rem; border: 3px solid #ff6b35;">
            <%= @user.name.first.upcase %>
          </div>
        </div>
      <% end %>

      <div class="form-group">
        <%= f.label :avatar, "Upload New Profile Picture", class: "form-label" %>
        <%= f.file_field :avatar, accept: 'image/*', style: "padding: 0.8rem; border: 1px solid #ddd; border-radius: 6px; width: 100%;" %>
        <small style="color: #757575; font-size: 0.85rem;">Recommended: Square image, at least 200x200px</small>
      </div>
    </div>

    <div style="display: flex; gap: 1rem; justify-content: flex-end;">
      <%= link_to "Cancel", root_path, style: "padding: 0.8rem 2rem; color: #757575; text-decoration: none; border: 1px solid #ddd; border-radius: 24px; font-weight: 600;" %>
      <%= f.submit "Save Changes", class: "btn-primary" %>
    </div>
  <% end %>
</div>
