<div class="form-container">
  <%= form_with(model: blog) do |form| %>
    <% if blog.errors.any? %>
      <div class="alert alert-error" style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">
          <%= pluralize(blog.errors.count, "error") %> prohibited this blog from being saved:
        </h3>
        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
          <% blog.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= form.label :title, "Title", class: "form-label" %>
      <%= form.text_field :title, class: "form-input", placeholder: "Enter an engaging title...", style: "font-size: 1.5rem; font-weight: 600;" %>
    </div>

    <div class="form-group">
      <%= form.label :body, "Tell your story...", class: "form-label" %>
      
      <!-- rich text editor toolbar -->
      <div id="editor-toolbar" style="background: #f5f5f5; border: 1px solid #ddd; border-bottom: none; border-radius: 6px 6px 0 0; padding: 0.8rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
        <!-- text formatting -->
        <button type="button" id="bold-btn" class="toolbar-btn" title="Bold (Ctrl+B)">
          <strong>B</strong>
        </button>
        <button type="button" id="italic-btn" class="toolbar-btn" title="Italic (Ctrl+I)">
          <em>I</em>
        </button>
        <button type="button" id="underline-btn" class="toolbar-btn" title="Underline (Ctrl+U)">
          <u>U</u>
        </button>
        
        <span style="border-left: 2px solid #ddd; margin: 0 0.3rem;"></span>
        
        <!-- headings -->
        <button type="button" id="h1-btn" class="toolbar-btn" title="Heading 1">H1</button>
        <button type="button" id="h2-btn" class="toolbar-btn" title="Heading 2">H2</button>
        <button type="button" id="h3-btn" class="toolbar-btn" title="Heading 3">H3</button>
        <button type="button" id="p-btn" class="toolbar-btn" title="Paragraph">P</button>
        
        <span style="border-left: 2px solid #ddd; margin: 0 0.3rem;"></span>
        
        <!-- lists -->
        <button type="button" id="ol-btn" class="toolbar-btn" title="Numbered List">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 4h1v1H2V4zm0 3h1v1H2V7zm0 3h1v1H2v-1z"/>
            <path d="M5 4h9v1H5V4zm0 3h9v1H5V7zm0 3h9v1H5v-1z"/>
          </svg>
        </button>
        <button type="button" id="ul-btn" class="toolbar-btn" title="Bullet List">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <circle cx="2" cy="4.5" r="1"/>
            <circle cx="2" cy="8" r="1"/>
            <circle cx="2" cy="11.5" r="1"/>
            <path d="M5 4h9v1H5V4zm0 3.5h9v1H5v-1zm0 3.5h9v1H5v-1z"/>
          </svg>
        </button>
        
        <span style="border-left: 2px solid #ddd; margin: 0 0.3rem;"></span>
        
        <!-- colors -->
        <button type="button" id="color-btn" class="toolbar-btn" title="Text Color">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8 1l-6 14h3l1-2h4l1 2h3L8 1zm0 3l1.5 4h-3L8 4z"/>
          </svg>
        </button>
        <input type="color" id="color-picker" style="display: none;" value="#000000">
        
        <button type="button" id="highlight-btn" class="toolbar-btn" title="Highlight Color">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M3 14h10v2H3v-2z"/>
            <path d="M6 2l4 8-2 1-4-8 2-1z"/>
          </svg>
        </button>
        <input type="color" id="highlight-picker" style="display: none;" value="#ffff00">
        
        <span style="border-left: 2px solid #ddd; margin: 0 0.3rem;"></span>
        
        <!-- alignment -->
        <button type="button" id="align-left-btn" class="toolbar-btn" title="Align Left">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 3h12v1H2V3zm0 3h8v1H2V6zm0 3h12v1H2V9zm0 3h8v1H2v-1z"/>
          </svg>
        </button>
        <button type="button" id="align-center-btn" class="toolbar-btn" title="Align Center">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 3h12v1H2V3zm2 3h8v1H4V6zm-2 3h12v1H2V9zm2 3h8v1H4v-1z"/>
          </svg>
        </button>
        <button type="button" id="align-right-btn" class="toolbar-btn" title="Align Right">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 3h12v1H2V3zm4 3h8v1H6V6zm-4 3h12v1H2V9zm4 3h8v1H6v-1z"/>
          </svg>
        </button>
        
        <span style="border-left: 2px solid #ddd; margin: 0 0.3rem;"></span>
        
        <!-- link and image -->
        <button type="button" id="link-btn" class="toolbar-btn" title="Insert Link">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"/>
          </svg>
        </button>
        <button type="button" id="image-btn" class="toolbar-btn" title="Insert Image">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 2h12v12H2V2zm1 1v10h10V3H3zm2 2l2 3 2-2 3 4H4l1-5z"/>
            <circle cx="5.5" cy="6.5" r="1"/>
          </svg>
        </button>
        <input type="file" id="image-input" accept="image/*" style="display: none;">
        
        <span style="border-left: 2px solid #ddd; margin: 0 0.3rem;"></span>
        
        <!-- quote -->
        <button type="button" id="quote-btn" class="toolbar-btn" title="Quote">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 3h12v2H2V3zm0 4h12v2H2V7zm0 4h8v2H2v-2z"/>
          </svg>
        </button>
        
        <!-- clear formatting -->
        <button type="button" id="clear-btn" class="toolbar-btn" title="Clear Formatting">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8 1l-6 14h3l1-2h4l1 2h3L8 1zm0 3l1.5 4h-3L8 4z"/>
            <path d="M13 2l-2 2m0-2l2 2"/>
          </svg>
        </button>
      </div>
      
      <!-- contenteditable div for rich text editing -->
      <div id="blog-editor" 
           contenteditable="true" 
           class="form-textarea"
           style="min-height: 400px; font-size: 1.1rem; line-height: 1.8; border-radius: 0 0 6px 6px; overflow-y: auto; max-height: 600px;"
           placeholder="Write your blog content here..."><%= blog.body %></div>
      
      <!-- hidden field to store HTML content -->
      <%= form.hidden_field :body, value: blog.body %>
      
      <small style="color: #757575; font-size: 0.85rem; margin-top: 0.5rem; display: block;">
        Tip: Select text and click formatting buttons. Use the image button to upload images. Use the link button to add clickable links.
      </small>
    </div>

    <div style="display: flex; gap: 1rem; justify-content: flex-end;">
      <%= link_to "Cancel", blogs_path, style: "padding: 0.8rem 2rem; color: #757575; text-decoration: none; border: 1px solid #ddd; border-radius: 24px; font-weight: 600;" %>
      <%= form.submit (blog.new_record? ? "Save as Draft" : "Update"), class: "btn-primary" %>
    </div>
  <% end %>
</div>
